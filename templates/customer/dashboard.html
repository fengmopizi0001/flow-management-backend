{% extends "base.html" %}

{% block title %}æˆ‘çš„ä»ªè¡¨ç›˜ - æµæ°´ç®¡ç†ç³»ç»Ÿ{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2>ğŸ“Š {{ session.username }}çš„æµæ°´ä»ªè¡¨ç›˜</h2>
    </div>
    <div class="card-body">
        {% if latest_target %}
        <div class="target-overview">
            <div class="target-header">
                <span class="target-badge">ç¬¬ {{ latest_target.period_number }} æœŸ</span>
                <span class="target-period">{{ latest_target.start_date }} è‡³ {{ latest_target.end_date }}</span>
            </div>
            <div class="target-amount">ç›®æ ‡ï¼šÂ¥{{ "{:,.0f}".format(latest_target.target_amount) }}</div>
            
            <div class="progress-container">
                <div class="progress-bar-fill {% if progress >= 100 %}completed{% endif %}" 
                     style="width: {{ progress if progress <= 100 else 100 }}%"></div>
            </div>
            <div style="margin-top: 5px; text-align: right; font-size: 0.85rem; color: var(--gray-600);">
                å½“å‰è¿›åº¦: {{ "{:.1f}".format(progress) }}%
            </div>
        </div>
        {% else %}
        <div class="alert alert-info">
            æš‚æ— æœ¬æœˆåº¦ç›®æ ‡ï¼Œè¯·è”ç³»ç®¡ç†å‘˜è®¾ç½®
        </div>
        {% endif %}

        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="stats-grid">
            <div class="stat-card success">
                <div class="stat-label">å·²åˆ·æµæ°´</div>
                <div class="stat-value">Â¥{{ "{:,.0f}".format(stats.completed or 0) }}</div>
                <div class="stat-desc">{{ stats.completed_count or 0 if stats else 0 }} ç¬”äº¤æ˜“</div>
            </div>
            
            <div class="stat-card warning">
                <div class="stat-label">å¾…åˆ·æµæ°´</div>
                <div class="stat-value">Â¥{{ "{:,.0f}".format((stats.total or 0) - (stats.completed or 0)) }}</div>
                <div class="stat-desc">{{ (stats.total_count or 0 if stats else 0) - (stats.completed_count or 0 if stats else 0) }} ç¬”äº¤æ˜“</div>
            </div>
            
            <div class="stat-card info">
                <div class="stat-label">å®Œæˆè¿›åº¦</div>
                <div class="stat-value">{{ "{:.1f}".format(progress) }}%</div>
                <div class="stat-desc">åŠ æ²¹ï¼</div>
            </div>
        </div>

        <!-- å¿«æ·æ“ä½œ -->
        <h3 style="margin: 20px 0 15px; font-size: 1.1rem; color: var(--gray-700);">âš¡ å¿«æ·æ“ä½œ</h3>
        <div class="customer-actions">
            <a href="{{ url_for('customer.records') }}" class="action-card">
                <div class="action-icon">ğŸ“‹</div>
                <div class="action-text">æŸ¥çœ‹æµæ°´æ˜ç»†</div>
            </a>
            <a href="{{ url_for('customer_operator.index') }}" class="action-card">
                <div class="action-icon">ğŸ‘¥</div>
                <div class="action-text">æ“ä½œå‘˜ç®¡ç†</div>
            </a>
            <a href="{{ url_for('query.index') }}" class="action-card">
                <div class="action-icon">ğŸ”</div>
                <div class="action-text">æŸ¥è¯¢æµæ°´</div>
            </a>
        </div>
    </div>
</div>
{% endblock %}
